---
kind: pipeline
name: default

platform:
  os: linux
  arch: amd64

steps:
- name: Build
  image: composer
  commands:
  - composer install --prefer-dist

- name: PHPUnit Test
  image: php:7.3-rc-cli-alpine
  commands:
  - php -v
  - cp .env.example .env
  - php artisan key:generate
  - vendor/bin/phpunit --configuration phpunit.xml

- name: Deploy to ECR test
  image: ubuntu:latest
  commands:
  - echo "$DB_HOST" > wow.txt

- name: Deploy to dockerhub 
  image: plugins/docker
  settings:
    username: ainlavong
    password: 
      from_secret: DOCKERHUB_PASS
    repo: foobar
    tags: latest
...
